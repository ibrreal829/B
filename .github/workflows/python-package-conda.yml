name: CI with Conda

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up Miniconda
      uses: conda-incubator/setup-miniconda@v2
      with:
        python-version: 3.10
        auto-update-conda: true
        activate-environment: base
        use-mamba: true

    - name: Update Conda environment
      run: conda env update --file environment.yml --name base

    - name: Lint and Test
      run: |
        conda run -n base flake8 .
        conda run -n base pytest
